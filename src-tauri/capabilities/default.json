{
    "$schema": "https://schema.tauri.app/config/2/capability",
    "identifier": "default",
    "description": "Default capabilities for Isolate",
    "windows": [
        "main"
    ],
    "permissions": [
        "core:path:default",
        "core:event:default",
        "core:window:default",
        "core:app:default",
        "shell:allow-open",
        {
            "identifier": "shell:allow-execute",
            "allow": [
                {
                    "name": "winws",
                    "cmd": "winws.exe",
                    "args": [
                        { "validator": "^--wf-tcp$" },
                        { "validator": "^--wf-udp$" },
                        { "validator": "^--filter$" },
                        { "validator": "^--filter-tcp$" },
                        { "validator": "^--filter-udp$" },
                        { "validator": "^--filter-l3$" },
                        { "validator": "^--filter-l7$" },
                        { "validator": "^--filter-ssid$" },
                        { "validator": "^--hostlist$" },
                        { "validator": "^--hostlist-exclude$" },
                        { "validator": "^--hostlist-domains$" },
                        { "validator": "^--ipset$" },
                        { "validator": "^--ipset-exclude$" },
                        { "validator": "^--ip-id$" },
                        { "validator": "^--dpi-desync$" },
                        { "validator": "^--dpi-desync-l7$" },
                        { "validator": "^--dpi-desync-ipid$" },
                        { "validator": "^--dpi-desync-repeats$" },
                        { "validator": "^--dpi-desync-split-seqovl$" },
                        { "validator": "^--dpi-desync-split-pos$" },
                        { "validator": "^--dpi-desync-split-seqovl-pattern$" },
                        { "validator": "^--dpi-desync-fooling$" },
                        { "validator": "^--dpi-desync-fake-tls$" },
                        { "validator": "^--dpi-desync-fake-quic$" },
                        { "validator": "^--dpi-desync-fake-tls-mod$" },
                        { "validator": "^--dpi-desync-fake-wireguard$" },
                        { "validator": "^--dpi-desync-fake-dht$" },
                        { "validator": "^--dpi-desync-fake-unknown-udp$" },
                        { "validator": "^--dpi-desync-fake-tcp-mod$" },
                        { "validator": "^--dpi-desync-fake-syndata$" },
                        { "validator": "^--dpi-desync-ttl$" },
                        { "validator": "^--dpi-desync-ttl6$" },
                        { "validator": "^--dpi-desync-autottl$" },
                        { "validator": "^--dpi-desync-badseq-increment$" },
                        { "validator": "^--dpi-desync-badack-increment$" },
                        { "validator": "^--dpi-desync-ts-increment$" },
                        { "validator": "^--dpi-desync-cutoff$" },
                        { "validator": "^--dpi-desync-hostfakesplit-mod$" },
                        { "validator": "^--dpi-desync-hostfakesplit-midhost$" },
                        { "validator": "^--dpi-desync-hostfakesplit-midsld$" },
                        { "validator": "^--dpi-desync-fakedsplit-mod$" },
                        { "validator": "^--dpi-desync-dup$" },
                        { "validator": "^--dpi-desync-dup-replace$" },
                        { "validator": "^--dpi-desync-dup-ttl$" },
                        { "validator": "^--dpi-desync-dup-autottl$" },
                        { "validator": "^--dpi-desync-dup-fooling$" },
                        { "validator": "^--wsize$" },
                        { "validator": "^--wssize$" },
                        { "validator": "^--wssize-cutoff$" },
                        { "validator": "^--nlm-filter$" },
                        { "validator": "^--new$" },
                        { "validator": "^[0-9,]+$" },
                        { "validator": "^(tcp|udp|ip|ipv4|ipv6|http|tls|quic|dns|stun|discord|wireguard|dht|unknown|fakeknown)$" },
                        { "validator": "^(fake|rst|rstack|synack|syndata|disorder|disorder2|split|split2|ipfrag1|ipfrag2|hopbyhop|destopt|ipfrag1\\+destopt|hopbyhop\\+destopt|udplen|tamper|fakedsplit|multisplit|multidisorder|hostfakesplit)(,(fake|rst|rstack|synack|syndata|disorder|disorder2|split|split2|ipfrag1|ipfrag2|hopbyhop|destopt|ipfrag1\\+destopt|hopbyhop\\+destopt|udplen|tamper|fakedsplit|multisplit|multidisorder|hostfakesplit))*$" },
                        { "validator": "^(md5sig|badsum|datanoack|hopbyhop|hopbyhop2|badseq|badack|ts|ts2)(,(md5sig|badsum|datanoack|hopbyhop|hopbyhop2|badseq|badack|ts|ts2))*$" },
                        { "validator": "^[a-zA-Z]:[\\\\][^<>:\"|?*]+$" },
                        { "validator": "^[0-9]+$" },
                        { "validator": "^[0-9]+:[0-9]+:[0-9]+$" },
                        { "validator": "^(n|d|s)[0-9]+$" },
                        { "validator": "^[a-zA-Z0-9._-]+$" },
                        { "validator": "^(midsld|midhost)$" }
                    ]
                },
                {
                    "name": "singbox",
                    "cmd": "sing-box.exe",
                    "args": [
                        "run",
                        "-c",
                        { "validator": "^[a-zA-Z]:[\\\\][^<>:\"|?*]+\\.json$" },
                        { "validator": "^[A-Za-z0-9_\\-\\\\/:.]+\\.json$" }
                    ]
                }
            ]
        },
        {
            "identifier": "shell:allow-spawn",
            "allow": [
                {
                    "name": "winws",
                    "cmd": "winws.exe",
                    "args": [
                        { "validator": "^--wf-tcp$" },
                        { "validator": "^--wf-udp$" },
                        { "validator": "^--filter$" },
                        { "validator": "^--filter-tcp$" },
                        { "validator": "^--filter-udp$" },
                        { "validator": "^--filter-l3$" },
                        { "validator": "^--filter-l7$" },
                        { "validator": "^--filter-ssid$" },
                        { "validator": "^--hostlist$" },
                        { "validator": "^--hostlist-exclude$" },
                        { "validator": "^--hostlist-domains$" },
                        { "validator": "^--ipset$" },
                        { "validator": "^--ipset-exclude$" },
                        { "validator": "^--ip-id$" },
                        { "validator": "^--dpi-desync$" },
                        { "validator": "^--dpi-desync-l7$" },
                        { "validator": "^--dpi-desync-ipid$" },
                        { "validator": "^--dpi-desync-repeats$" },
                        { "validator": "^--dpi-desync-split-seqovl$" },
                        { "validator": "^--dpi-desync-split-pos$" },
                        { "validator": "^--dpi-desync-split-seqovl-pattern$" },
                        { "validator": "^--dpi-desync-fooling$" },
                        { "validator": "^--dpi-desync-fake-tls$" },
                        { "validator": "^--dpi-desync-fake-quic$" },
                        { "validator": "^--dpi-desync-fake-tls-mod$" },
                        { "validator": "^--dpi-desync-fake-wireguard$" },
                        { "validator": "^--dpi-desync-fake-dht$" },
                        { "validator": "^--dpi-desync-fake-unknown-udp$" },
                        { "validator": "^--dpi-desync-fake-tcp-mod$" },
                        { "validator": "^--dpi-desync-fake-syndata$" },
                        { "validator": "^--dpi-desync-ttl$" },
                        { "validator": "^--dpi-desync-ttl6$" },
                        { "validator": "^--dpi-desync-autottl$" },
                        { "validator": "^--dpi-desync-badseq-increment$" },
                        { "validator": "^--dpi-desync-badack-increment$" },
                        { "validator": "^--dpi-desync-ts-increment$" },
                        { "validator": "^--dpi-desync-cutoff$" },
                        { "validator": "^--dpi-desync-hostfakesplit-mod$" },
                        { "validator": "^--dpi-desync-hostfakesplit-midhost$" },
                        { "validator": "^--dpi-desync-hostfakesplit-midsld$" },
                        { "validator": "^--dpi-desync-fakedsplit-mod$" },
                        { "validator": "^--dpi-desync-dup$" },
                        { "validator": "^--dpi-desync-dup-replace$" },
                        { "validator": "^--dpi-desync-dup-ttl$" },
                        { "validator": "^--dpi-desync-dup-autottl$" },
                        { "validator": "^--dpi-desync-dup-fooling$" },
                        { "validator": "^--wsize$" },
                        { "validator": "^--wssize$" },
                        { "validator": "^--wssize-cutoff$" },
                        { "validator": "^--nlm-filter$" },
                        { "validator": "^--new$" },
                        { "validator": "^[0-9,]+$" },
                        { "validator": "^(tcp|udp|ip|ipv4|ipv6|http|tls|quic|dns|stun|discord|wireguard|dht|unknown|fakeknown)$" },
                        { "validator": "^(fake|rst|rstack|synack|syndata|disorder|disorder2|split|split2|ipfrag1|ipfrag2|hopbyhop|destopt|ipfrag1\\+destopt|hopbyhop\\+destopt|udplen|tamper|fakedsplit|multisplit|multidisorder|hostfakesplit)(,(fake|rst|rstack|synack|syndata|disorder|disorder2|split|split2|ipfrag1|ipfrag2|hopbyhop|destopt|ipfrag1\\+destopt|hopbyhop\\+destopt|udplen|tamper|fakedsplit|multisplit|multidisorder|hostfakesplit))*$" },
                        { "validator": "^(md5sig|badsum|datanoack|hopbyhop|hopbyhop2|badseq|badack|ts|ts2)(,(md5sig|badsum|datanoack|hopbyhop|hopbyhop2|badseq|badack|ts|ts2))*$" },
                        { "validator": "^[a-zA-Z]:[\\\\][^<>:\"|?*]+$" },
                        { "validator": "^[0-9]+$" },
                        { "validator": "^[0-9]+:[0-9]+:[0-9]+$" },
                        { "validator": "^(n|d|s)[0-9]+$" },
                        { "validator": "^[a-zA-Z0-9._-]+$" },
                        { "validator": "^(midsld|midhost)$" }
                    ]
                },
                {
                    "name": "singbox",
                    "cmd": "sing-box.exe",
                    "args": [
                        "run",
                        "-c",
                        { "validator": "^[a-zA-Z]:[\\\\][^<>:\"|?*]+\\.json$" },
                        { "validator": "^[A-Za-z0-9_\\-\\\\/:.]+\\.json$" }
                    ]
                }
            ]
        },
        "shell:allow-kill",
        "updater:default",
        "mcp-bridge:default"
    ]
}
